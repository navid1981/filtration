
import org.junit.Assert;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.InjectMocks;
import org.mockito.MockitoAnnotations;
import org.mockito.junit.MockitoJUnitRunner;
import org.junit.runner.RunWith;
import org.navid.model.Type;
import org.navid.service.FilterService;


@RunWith(MockitoJUnitRunner.class)
public class FilterServiceTest {
    @InjectMocks
    FilterService filterService=new FilterService();
    private static String payload="{\"people\":[{\"name\":\"Ali\",\"address\":{\"street\":\"1211 W Roosevelt Rd\",\"city\":\"Chicago\",\"state\":\"IL\",\"zipcode\":\"60608\",\"counrty\":\"US\"}},{\"name\":\"David\",\"address\":{\"street\":\"1211 Lee Highway\",\"city\":\"Fairfax\",\"state\":\"VA\",\"zipcode\":\"50608\",\"counrty\":\"US\"}},{\"name\":\"Jack\",\"address\":{\"street\":\"1011 E Main Dr\",\"city\":\"Newyork\",\"state\":\"NY\",\"zipcode\":\"60208\",\"counrty\":\"US\"}}]}";
    private static String filter="{\"rules\":[{\"name\":\"A\",\"path\":\"people.[*].address.[?]\",\"key\":\"city\",\"value\":\"Chicago\",\"condition\":\"eq\"},{\"name\":\"B\",\"path\":\"people.[*].address.[?]\",\"key\":\"state\",\"value\":\"TX\",\"condition\":\"eq\"},{\"name\":\"C\",\"path\":\"people.[*].address.[?]\",\"key\":\"state\",\"value\":\"VA\",\"condition\":\"eq\"}],\"rulesExpression\":\"A && ( B || C )\"}";

//    private static String filter="{\"rules\":[{\"name\":\"A\",\"path\":\"partyDetails.[*].CustomerOrgIdentifiers.item.[*].Ex_SrcSys[?]\",\"key\":\"Ex_SrcSys\",\"value\":\"EBS           \",\"condition\":\"eq\"},{\"name\":\"B\",\"path\":\"partyDetails.[*].CustomerOrgIdentifiers.item.[*].Ex_SrcSys[?]\",\"key\":\"Ex_SrcSys\",\"value\":\"SAP_CRM\",\"condition\":\"eq\"},{\"name\":\"C\",\"path\":\"partyDetails.[*].CustomerOrgIdentifiers.item.[*].Ex_SrcSys[?]\",\"key\":\"Ex_SrcSys\",\"value\":\"EBS           \",\"condition\":\"eq\"}],\"rulesExpression\":\"A && ( B || C )\"}";
//
//    private static String payload="{\"partyDetails\":[{\"matchScore\":100,\"winningUuid\":\"5038394548\",\"losingUuid\":[\"5038366613\",\"5038371846\",\"5038371872\",\"5038366614\",\"5038371849\"],\"rowidObject\":\"54250250\",\"creator\":\"syscrud\",\"createDate\":\"2022-02-04T02:29:41.767-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-09T03:56:21.906-08:00\",\"lastRowidSystem\":\"EBS\",\"fullNm\":\"Anz Bank Private Ltd\",\"prtyTyp\":\"Org\",\"cnfdncCd\":\"0\",\"uuid\":\"5038394548\",\"StgType\":{\"stgNm\":\"CONVERTED\",\"stgCd\":\"CONVERTED\"},\"prtySts\":{\"stsCd\":\"ACTIVE\",\"stsNm\":\"ACTIVE\"},\"CustomerOrgPostalAddress\":{\"item\":[{\"addrTyp\":{\"addrTypDesc\":\"Primary\",\"addrTyp\":\"Primary\"},\"rowidObject\":\"31060185\",\"PostalAddress\":{\"rowidObject\":\"16760250\",\"creator\":\"syscrud\",\"createDate\":\"2022-02-04T02:29:41.767-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-09T03:56:21.906-08:00\",\"lastRowidSystem\":\"EBS\",\"addrLn1\":\"300 COLLINS STREET\",\"city\":\"MELBOURNE\",\"pstlCd\":\"3000\",\"enrchdInd\":\"N\",\"srcAddrLn1\":\"300 Collins Street\",\"srcCity\":\"Melbourne\",\"srcPstlCd\":\"3000\",\"srcState\":\"VIC\",\"srcCntryCd\":\"AU\",\"cntryCd\":{\"cntryCd\":\"AU\",\"cntryDesc\":\"Australia\"},\"state\":{\"stateCd\":\"AU|VIC\",\"stateDesc\":\"Victoria\"},\"mlbltyScr\":{\"mlbltyScrTyp\":\"5\"}}}]},\"ExCustomerOrgRole\":{\"item\":[{\"creator\":\"syscrud\",\"createDate\":\"2022-02-04T02:29:41.767-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-04T02:29:41.767-08:00\",\"lastRowidSystem\":\"EBS\",\"ExRleTyp\":{\"rleTp\":\"CUST\",\"rleDesc\":\"CUSTOMER\"}},{\"creator\":\"syscrud\",\"createDate\":\"2022-02-08T04:58:22.464-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-08T04:58:22.464-08:00\",\"lastRowidSystem\":\"EBS\",\"ExRleTyp\":{\"rleTp\":\"CUST\",\"rleDesc\":\"CUSTOMER\"}},{\"creator\":\"syscrud\",\"createDate\":\"2022-02-09T03:56:22.189-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-09T03:56:22.189-08:00\",\"lastRowidSystem\":\"EBS\",\"ExRleTyp\":{\"rleTp\":\"CUST\",\"rleDesc\":\"CUSTOMER\"}}]},\"CustomerOrgIdentifiers\":{\"item\":[{\"creator\":\"syscrud\",\"createDate\":\"2022-02-04T02:29:41.767-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-04T02:30:17.696-08:00\",\"lastRowidSystem\":\"EBS\",\"altIdVal\":\"1235**04022022\",\"altIdTyp\":{\"idTyp\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\",\"idTypDesc\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\"},\"Ex_SrcInactFlg\":{\"Ex_SrcInactFlg\":\"YES\",\"Ex_SrcInactFlgDsc\":\"YES\"},\"Ex_SrcSys\":{\"Ex_SrcSys\":\"EBS           \",\"Ex_SrcSysDesc\":\"EBS\"}},{\"creator\":\"syscrud\",\"createDate\":\"2022-02-04T02:57:54.537-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-04T02:57:54.537-08:00\",\"lastRowidSystem\":\"EBS\",\"altIdVal\":\"1236**04022022\",\"altIdTyp\":{\"idTyp\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\",\"idTypDesc\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\"},\"Ex_SrcInactFlg\":{\"Ex_SrcInactFlg\":\"YES\",\"Ex_SrcInactFlgDsc\":\"YES\"},\"Ex_SrcSys\":{\"Ex_SrcSys\":\"EBS           \",\"Ex_SrcSysDesc\":\"EBS\"}},{\"creator\":\"syscrud\",\"createDate\":\"2022-02-08T04:54:46.253-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-08T05:00:52.226-08:00\",\"lastRowidSystem\":\"EBS\",\"altIdVal\":\"1239**04022022\",\"altIdTyp\":{\"idTyp\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\",\"idTypDesc\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\"},\"Ex_SrcInactFlg\":{\"Ex_SrcInactFlg\":\"YES\",\"Ex_SrcInactFlgDsc\":\"YES\"},\"Ex_SrcSys\":{\"Ex_SrcSys\":\"SFDC_PARTNER\",\"Ex_SrcSysDesc\":\"EBS\"}},{\"creator\":\"syscrud\",\"createDate\":\"2022-02-08T05:00:53.301-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-08T05:00:53.301-08:00\",\"lastRowidSystem\":\"EBS\",\"altIdVal\":\"1240**04022022\",\"altIdTyp\":{\"idTyp\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\",\"idTypDesc\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\"},\"Ex_SrcInactFlg\":{\"Ex_SrcInactFlg\":\"YES\",\"Ex_SrcInactFlgDsc\":\"YES\"},\"Ex_SrcSys\":{\"Ex_SrcSys\":\"EBS           \",\"Ex_SrcSysDesc\":\"EBS\"}},{\"creator\":\"syscrud\",\"createDate\":\"2022-02-08T05:09:32.548-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-08T05:09:32.548-08:00\",\"lastRowidSystem\":\"EBS\",\"altIdVal\":\"1241**04022022\",\"altIdTyp\":{\"idTyp\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\",\"idTypDesc\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\"},\"Ex_SrcInactFlg\":{\"Ex_SrcInactFlg\":\"NO\",\"Ex_SrcInactFlgDsc\":\"NO\"},\"Ex_SrcSys\":{\"Ex_SrcSys\":\"EBS           \",\"Ex_SrcSysDesc\":\"EBS\"}},{\"creator\":\"syscrud\",\"createDate\":\"2022-02-09T03:56:22.189-08:00\",\"updatedBy\":\"syscrud\",\"lastUpdateDate\":\"2022-02-09T03:56:22.189-08:00\",\"lastRowidSystem\":\"EBS\",\"altIdVal\":\"1299**04022022\",\"altIdTyp\":{\"idTyp\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\",\"idTypDesc\":\"CUST_ACCT_ID**CUST_ACCT_SITE_ID\"},\"Ex_SrcInactFlg\":{\"Ex_SrcInactFlg\":\"NO\",\"Ex_SrcInactFlgDsc\":\"NO\"},\"Ex_SrcSys\":{\"Ex_SrcSys\":\"EBS           \",\"Ex_SrcSysDesc\":\"EBS\"}}]}}],\"transactionResult\":{\"transactionCode\":\"M1022\",\"transactionMessage\":\"Party record has been found by name and address search match.\",\"httpCode\":200},\"count\":1}\n";

    @BeforeEach
    public void setUp() {
        MockitoAnnotations.openMocks(this);
    }

    @Test
    @org.junit.Test
    public void hasFilter(){
        boolean result=filterService.hasFilter(payload,filter, Type.JSON);
        Assert.assertEquals(true,result);
    }
}
